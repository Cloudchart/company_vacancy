<%- class_for_main 'cloud-profile' -%>
<%- cloud_profile_nav_current_tab :subscriptions -%>
<%= render 'shared/nav' %>

<ul>
  <% @subscriptions.each do |subscription| %>
    <li>
      <%= link_to subscription.subscribable.try(:name), main_app.send("#{subscription.subscribable_type.underscore}_path", subscription.subscribable) %>

      <%= simple_form_for subscription, url: main_app.subscription_path(subscription) do |f| %>  
        <%= f.input :subscribable_id, as: :hidden %>
        <%= f.input :subscribable_type, as: :hidden %>

        <%= f.simple_fields_for :types do |ff| %>
          <% Subscription::TYPES.each do |type| %>
            <%= ff.input type, as: :boolean, checked_value: type, input_html: { checked: subscription.types.include?(type) } %>
          <% end %>
        <% end %>

        <%= f.submit %>
      <% end %>

      <%= button_to 'Unsubscribe', main_app.subscription_path(subscription), method: :delete, data: { confirm: 'Are you sure?' } %>

    </li>
  <% end %>
</ul>
