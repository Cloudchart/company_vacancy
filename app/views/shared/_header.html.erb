<%

links = []
user = {}

if user_authenticated?
  if current_user.has_any_followed_users_or_pinboards?
    links << {
      title: 'Feed',
      url: current_page?(main_app.feed_path) ? nil : main_app.feed_path
    }
  end

  user = { id: current_user.id, name: current_user.full_name, url: user_path(current_user) }
end

if can?(:index, Pinboard)
  links << {
    title: 'Collections',
    url: current_page?(main_app.collections_path) ? nil : main_app.collections_path
  }
end

if can?(:index, Company)
  links << {
    title: 'Companies',
    is_beta: true,
    url: current_page?(main_app.companies_path) ? nil : main_app.companies_path
  }
end

if can?(:search, Pin)
  links << {
    title: 'Search',
    url: current_page?(main_app.search_insights_path) ? nil : main_app.search_insights_path
  }
end

%>

<%= content_tag :header, nil, data: {
  "react-class" => "components/header_app",
  "react-props" => {
    title: app_name_for_header,
    root_url: main_app.root_path,
    login_url: cloud_profile.login_path,
    logout_url: cloud_profile.logout_path,
    links: links,
    user: user
  }
} %>
